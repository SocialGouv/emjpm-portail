include:
  - project: SocialGouv/gitlab-ci-yml
    file: /autodevops.yml
    ref: v23.0.1

variables:
  AUTO_DEVOPS_KANIKO: "ğŸ•¹ï¸"
  AUTO_DEVOPS_RELEASE_AUTO: "ğŸ”–"
  AUTO_DEVOPS_ENABLE_KAPP: "ğŸ•¹ï¸"
  AUTO_DEVOPS_PRODUCTION_AUTO: "ğŸš€"
  AUTO_DEVOPS_TEST_DISABLED: "ğŸ›‘"
  AUTO_DEVOPS_QUALITY_DISABLED: "ğŸ›‘"

Build:
  needs: []
  cache:
    key:
      files:
        - yarn.lock
      prefix: ${CI_JOB_NAME}
    paths:
      - .cache
  script:
    - yarn config set cache-folder $CI_PROJECT_DIR/.cache/yarn
    - yarn --frozen-lockfile --prefer-offline
    - yarn build
    - yarn export
  variables:
    VERSION: ${CI_COMMIT_SHORT_SHA}
  artifacts:
    expire_in: 1 day
    paths:
      - out
